/* =========================================================
   Global / Page
========================================================= */
:root{
  --bg: #0f1220;
  --text: #e5e7eb;

  --panel-bg: rgba(0,0,0,.72);
  --panel-border: rgba(255,255,255,.14);
  --panel-radius: 14px;

  --bar-bg: rgba(0,0,0,.45);
  --bar-border: rgba(255,255,255,.12);

  --pad: 8px;
  --font: 12px/1.25 system-ui,-apple-system,Segoe UI,Roboto,Arial;
}

html, body{
  height:100%;
  margin:0;
  overflow:hidden;
  background: var(--bg);
  color: var(--text);
  -webkit-text-size-adjust: 100%;
}

/* =========================================================
   Canvas
   - The map is drawn here. UI is separate and clipped.
========================================================= */
#cityCanvas{
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;

  image-rendering: pixelated;
  image-rendering: crisp-edges;

  touch-action: none; /* we handle pan/pinch */
  user-select: none;
}

/* =========================================================
   Legacy DOM layers (NO LONGER USED)
   If you still have these in older HTML files, they won't hurt,
   but they also won't control anything in the canvas build.
========================================================= */
#cityView,
#cityViewport,
#cityContent,
#cityBase,
#gridCanvas,
#plotsLayer,
#buildingsLayer{
  display: none !important;
}

/* =========================================================
   UI Overlay (CLIPPED to the visible map rect)
   JS sets left/top/width/height each frame based on camera.
========================================================= */


/* top resource bar (inside overlay) */
/* top resource bar (inside overlay) */
#resourceBar{
  position:absolute;
  left:0; top:0; right:0;

  height:64px;
  padding:10px 14px;
  box-sizing:border-box;

  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;

  color:#eaf2ff;
  font: 14px/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  letter-spacing:.2px;

  /* cooler look */
  background: linear-gradient(180deg, rgba(20,35,20,.92), rgba(20,35,20,.74));
  border-bottom:1px solid rgba(255,255,255,.14);
  box-shadow: 0 10px 30px rgba(0,0,0,.35);

  pointer-events:auto;
  user-select:none;
  backdrop-filter: blur(8px);
}

#resourceLeft{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}

.resItem{
  display:flex;
  align-items:baseline;
  gap:6px;

  padding:8px 10px;
  border-radius:12px;

  background: rgba(255,255,255,.07);
  border: 1px solid rgba(255,255,255,.10);
}

.resItem b{
  font-weight:900;
  font-size:14px;
}

.resItem span{
  opacity:.75;
  font-weight:700;
  font-size:12px;
}

#resourceRight{
  display:flex;
  gap:10px;
  align-items:center;
}

#resourceRight button{
  padding:10px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.10);
  color:#eaf2ff;
  cursor:pointer;
  font-weight:800;
  letter-spacing:.2px;
}

#resourceRight button:hover{
  background: rgba(255,255,255,.16);
}



/* helpers for resource formatting (if you use spans) */
.resItem{ opacity:.95; }
.resAmt{ font-weight: 800; }
.resRate{ opacity:.70; font-weight: 600; margin-left: 4px; font-size: 11px; }

/* =========================================================
   Floating Panels Host (clipped by uiOverlay)
========================================================= */
#floatingPanels{
  position: absolute;
  inset: 0;
  pointer-events: none; /* panels re-enable pointer events */
}

/* Generic panel styling used by build popup & barracks panel */
.uiPanel{
  position: absolute;
  pointer-events: auto;

  background: var(--panel-bg);
  border: 1px solid var(--panel-border);
  border-radius: var(--panel-radius);
  color: var(--text);
  font: var(--font);

  padding: 12px;
  box-sizing: border-box;

  backdrop-filter: blur(6px);
  box-shadow: 0 18px 50px rgba(0,0,0,.55);
}

/* optional panel header helpers */
.uiPanel h3,
.uiPanel .panelTitle{
  margin: 0 0 8px 0;
  font-size: 14px;
  font-weight: 800;
}

.uiPanel .panelActions{
  display:flex;
  gap:8px;
  justify-content:flex-end;
}

/* =========================================================
   Build Popup (now lives INSIDE overlay, positioned by smartPlace)
========================================================= */
#buildPopup{
  display: none;
  min-width: 260px;
  max-width: 360px;
}

#buildTitle{
  font-weight: 800;
  margin-bottom: 8px;
}

#buildGrid{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
}

.buildBtn{
  padding: 10px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.22);
  background: rgba(255,255,255,.10);
  color: #fff;
  cursor: pointer;
  text-align: left;
  white-space: pre-line;
  font: inherit;
}

.buildBtn:hover{ background: rgba(255,255,255,.16); }

.row{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:10px;
}

.closeBtn{
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.15);
  background: rgba(255,255,255,.10);
  color: #fff;
  cursor: pointer;
  font: inherit;
}

.closeBtn:hover{ background: rgba(255,255,255,.16); }

/* ===== Barracks panel tabs ===== */
#barracksPanel{
  display:none;
  width: min(520px, calc(100vw - 24px));
  max-height: 70vh;
  overflow:hidden;               /* important: panel scroll is inside */
}

.bxWrap{
  display:flex;
  gap:0;
  min-height: 260px;
}

.bxTabs{
  width: 110px;
  padding: 10px;
  border-right: 1px solid rgba(255,255,255,.12);
  display:flex;
  flex-direction:column;
  gap:8px;
}

.bxTab{
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  color:#e5e7eb;
  border-radius:12px;
  padding:10px 10px;
  cursor:pointer;
  font: 13px/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  text-align:left;
}
.bxTab:hover{ background: rgba(255,255,255,.12); }
.bxTab.active{
  background: rgba(37,99,235,.25);
  border-color: rgba(37,99,235,.45);
}

.bxMain{
  flex:1;
  padding:12px;
  overflow:auto;                 /* scroll content, tabs stay put */
}

.bxHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  margin-bottom:10px;
}

.bxClose{
  background:rgba(255,255,255,.12);
  color:#e5e7eb;
  border:1px solid rgba(255,255,255,.12);
  border-radius:10px;
  padding:6px 8px;
  cursor:pointer;
}

/* =========================================================
   HUD (Legacy / debugging)
   You can remove #hud entirely from HTML once resource bar is live.
========================================================= */
#hud{
  display: none; /* turn off old HUD so it doesn’t fight the resource bar */
}

/* =========================================================
   Utilities
========================================================= */
.hidden{
  display:none !important;
  pointer-events:none !important;
}
.uiPanel button,
.uiPanel select,
.uiPanel input {
  touch-action: manipulation;
}
.uiPanel,
.uiPanel *{
  pointer-events: auto;
}

.uiPanel button,
.uiPanel select,
.uiPanel input{
  touch-action: manipulation;
}
.uiPanel,
.uiPanel * {
  pointer-events: auto;
}
#uiFixed{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1000;
}

/* panels float above canvas but stay inside screen */
.uiPanel{
  position:fixed;
  pointer-events:auto;

  width:min(420px, calc(100vw - 24px));
  max-height:calc(100vh - 170px); /* top+bottom HUD space */
  overflow:auto;

  border-radius:16px;
}
